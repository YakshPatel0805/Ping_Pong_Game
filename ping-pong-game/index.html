<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ping Pong Game</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: rgb(15, 15, 15); text-align: center; overflow: hidden; }
        .game-container { position: relative; width: 100vw; height: 100vh; }
        .rod { position: absolute; width: 200px; height: 15px; border-radius: 10px; background: rgb(42, 205, 230); }
        .ball { position: absolute; width: 25px; height: 25px; background: rgb(56, 211, 235); border-radius: 50%; box-shadow: 0 0 10px rgba(56, 211, 235, 0.8); }
        .ball-trail { position: absolute; width: 25px; height: 25px; background: rgba(56, 211, 235, 0.3); border-radius: 50%; pointer-events: none; transition: opacity 0.1s ease-out; }
    </style>
</head>
<body>
    <div class="game-container">
        <div id="rod1" class="rod"></div>
        <div id="rod2" class="rod"></div>
        <div id="ball" class="ball"></div>
    </div>
    <script>
        const rod1 = document.getElementById("rod1");
        const rod2 = document.getElementById("rod2");
        const ball = document.getElementById("ball");
        const gameContainer = document.querySelector(".game-container");
        let rodWidth = rod1.offsetWidth;
        let rodHeight = rod1.offsetHeight;
        let ballDiameter = ball.offsetWidth;
        let ballSpeedX = 2, ballSpeedY = 2;
        let ballX = 50, ballY = 50;
        let rodX = (window.innerWidth - rodWidth) / 2;
        let rodSpeed = 20;
        let gameOn = false;
        let score = 0;
        let highestScore = localStorage.getItem("highestScore") || 0;
        let highestPlayer = localStorage.getItem("highestPlayer") || "No one";

        // Trail effect variables
        let trailElements = [];

        function createTrailElement() {
            const trail = document.createElement('div');
            trail.className = 'ball-trail';
            gameContainer.appendChild(trail);
            return trail;
        }

        function updateTrail() {
            // Add current ball position to trail with timestamp
            const trailElement = createTrailElement();
            trailElement.style.left = `${ballX}px`;
            trailElement.style.top = `${ballY}px`;
            trailElement.style.opacity = '0.4';
            
            trailElements.push({
                element: trailElement,
                timestamp: Date.now()
            });
            
            // Remove trail elements older than 1 second
            trailElements = trailElements.filter(trail => {
                const age = Date.now() - trail.timestamp;
                if (age > 500) {
                    trail.element.remove();
                    return false;
                }
                
                // Fade out over time
                const fadeOpacity = 0.4 * (1 - age / 1000);
                trail.element.style.opacity = fadeOpacity;
                return true;
            });
        }

        alert(`Highest Score: ${highestScore} by ${highestPlayer}`);

        function resetGame(loser) {
            alert(`${loser} loses! Score: ${score}`);
            if (score > highestScore) {
                highestScore = score;
                let playerName = prompt("New High Score! Enter your name:") || "Anonymous";
                localStorage.setItem("highestScore", highestScore);
                localStorage.setItem("highestPlayer", playerName);
            }
            score = 0;
            ballX = (window.innerWidth - ballDiameter) / 2;
            ballY = loser === "Rod 1" ? 100 : window.innerHeight - 100;
            rodX = (window.innerWidth - rodWidth) / 2;
            gameOn = false;
        }

        function moveBall() {
            if (!gameOn) return;
            ballX += ballSpeedX;
            ballY += ballSpeedY;

            if (ballX <= 0 || ballX + ballDiameter >= window.innerWidth) {
                ballSpeedX = -ballSpeedX;
            }

            if (ballY <= rodHeight && ballX + ballDiameter >= rodX && ballX <= rodX + rodWidth) {
                ballSpeedY = -ballSpeedY;
                score++;
            } else if (ballY + ballDiameter >= window.innerHeight - rodHeight && ballX + ballDiameter >= rodX && ballX <= rodX + rodWidth) {
                ballSpeedY = -ballSpeedY;
                score++;
            }
            else if (ballY <= 0) {
                resetGame("Rod 1");
            }
            else if (ballY + ballDiameter >= window.innerHeight) {
                resetGame("Rod 2");
            }

            ball.style.left = `${ballX}px`;
            ball.style.top = `${ballY}px`;
            
            // Update trail effect
            updateTrail();
            
            requestAnimationFrame(moveBall);
        }

        document.addEventListener("keydown", (e) => {
            if (e.key === "ArrowLeft" && rodX > 0) {
                rodX -= rodSpeed;
            } else if (e.key === "ArrowRight" && rodX + rodWidth < window.innerWidth) {
                rodX += rodSpeed;
            } else if (e.key === "Enter" && !gameOn) {
                gameOn = true;
                moveBall();
            }
            rod1.style.left = `${rodX}px`;
            rod2.style.left = `${rodX}px`;
        });

        function positionElements() {
            rod1.style.top = "10px";
            rod2.style.bottom = "10px";
            rod1.style.left = `${rodX}px`;
            rod2.style.left = `${rodX}px`;
            ball.style.left = `${ballX}px`;
            ball.style.top = `${ballY}px`;
        }

        positionElements();
    </script>
</body>
</html>
